---
title: "Examen Parcial 1759004 - Jorge III Altamirano Astorga"
output: html_notebook
---
```{r librerías básicas, message=FALSE, warning=FALSE, include=FALSE}
library(tidyverse)
```

## Examen Parcial 
_1759004 Jorge III Altamirano Astorga_

Doctor Berdichevsky, presento este examen parcial para la Materia de Estadística Computacional (Otoño 2017). Agradeciendo de antemano su consideración y atenciones.

### 1. Manipulación y Visualización de Datos

a) Sí, es una de las bases de datos limpios debido a que cumple algunos de estos requisitos: 
    
    1. Cada observación corresponde a un renglón
    2. Cada variable tiene su columna
    3. Cada tipo de unidad observacional forma una tabla.
    
    
  Adicionalmente yo agregaría que todas no existen datos $NA$.
```{r}
summary(iris)
```

b) Impresión de las primeras y últimas 6 líneas
```{r}
head(iris, n = 6)
```
 
```{r}
tail(iris, n = 6)
```

c) Tenemos 150 observaciones y 5 variables

```{r}
dim(iris)
```
```{r}
str(iris)
```

d) La clase atómica de las variables en base al comando del inciso anterior son:
    * iris es un `data.frame`
    * Sepal.Length es un `num` ó numérica
    * Sepal.Width es un `num` ó numérica
    * Petal.Length es un `num` ó numérica
    * Petal.Width es un `num` ó numérica
    * Species es un `Factor` con 3 niveles: setosa, versicolor, virginica
    
e) Salida de las primeras 6 líneas sólo de la especie _Setosa_

```{r}
iris %>% filter(Species == 'setosa') %>% head(n = 6)
```

f) Salida de las primeras 6 observaciones en orden descendiente de _Petal.Length_

```{r}
iris %>% arrange(desc(Petal.Length)) %>% head(n=6)
```

g) Se crea la nueva variable de en mm de _Sepal.Length_. Mostrando las primeras  6 observaciones

```{r}
sepalLength <- iris$Sepal.Length*10
head(sepalLength, n=6)
```

Sin embargo en caso de que se quiera una columna aparte, es necesario usar `mutate`. Ahí no me quedó muy clara la pregunta. Por lo que anoto ambas respuestas aquí crée la columna _Sepal.Length.mm_.

```{r}
iris <- iris %>% mutate(Sepal.Length.mm = Sepal.Length*10)
head(iris, n=6)
```

h) Eliminando las observaciones con valores faltantes en _Sepal.Width_ e indicando el número de observaciones. *No existen observaciones no numéricas o valores negativos*, por lo que el número de observaciones se mantiene en 150.

```{r}
iris %>% filter(is.na(Sepal.Width) || Sepal.Width <= 0)
```

i) La media de _Petal.Width_ para cada una de las especies

```{r}
iris %>% select(Species, Petal.Width) %>% group_by(Species) %>% summarise(media = mean(Petal.Width))
```

j) Gráfica de dispersión donde $x = Sepal.Length$ y $y = Sepal.Width$; donde el color representa la especie. 

```{r}
ggplot(data = iris) +
  geom_point(aes(x = Sepal.Length, y = Sepal.Width, color = Species))
```

k) Gráfica de cajas de _Petal.Length_ donde se distingan las distintas especies.

```{r}
ggplot(iris, aes(y = Petal.Length, x = Species)) +
  geom_boxplot()
```

### 2. Espacio de probabilidad y Variables Aleatorias

Considere un experimento que consiste en una carrera de caballos con tres caballos numerados del 1 al 3. Si no está permitido que dos o más caballos lleguen a la meta en la misma posición:

a. ¿Cuál es el espacio de resultados $\Omega$ del experimento? 
```{r}
factorial(3)
```
b. ¿Cuál es esta probabilidad $P(\omega)$?
$$P(\omega) = \frac{1}{\omega} = \frac{1}{6} = 1.\overline{6}$$
```{r}
1/6
```

c. ¿Cuáles son los elementos de los eventos $A$ y $B$, respectivamente?

d. ¿Cuáles son los elementos del evento $A \cap B$?

e. ¿Cuáles son los elementos del event $A \cup B$?

f. ¿Cuál es la probabilidad $P(B)$ de que ocurra $B$?

g. Liste los valores $X(\omega)$ que toma la variable $X$ para cada uno de los elementos $\omega \in \Omega$

h. ¿Cuál es la probabilidad de $P(X = 1)$?

### 3. Probabilidad condicional

a. ¿Son $X$ y $Y$ variables independientes? 

b. Calcule las probabilidad condicionales $P(Y|X = x)$ para $x = 1,2,3,4$

c. Verifique que $P(Y|X)$ satisface la segunda regla de probabilidad $\sum_{y=o}^4 P(Y = y|X=x) = 1$ para $x=1,2,3,4$

d. Calcule los valores esperados condicionales $E[Y|X = x]$ para $x=1,2,3,4$.

e. Grafique $g(x) = E[Y|X = x]$ para $x=1,2,3,4$.

### 4. Bootstrap

a. La siguiente tabla al repetirla 500 veces

b. Realización de una gráfica de páneles mostrando los métodos normal, percentil y $BC_a$, en el eje horizontal graficando el número de intervalos de confianza ($1,2,...,500) y en el eje vertical graficando los límites de los intervalos, utilizando la función `geom_line` para las 2 líneas, correspondientes a los límites de los intervalos inferiores y superiores.

### 5. Simulación de Variables Aleatorias

a. Encuentre la relación de recurrencia entre $p_{i+1}$ y $p_i$ para $i \ge 0$

b. Utilizando la relación de recurrencia del inciso a., escriba un algoritmo de 5 pasos que genere una variable aleatoria binomial con parámetros $n$ y $p$ mediante el Método de Transformación Inversa Discreta.

c. Escriba en R una función que implemente el algoritmo del inciso $b$ para $n = 10$ y $p = 0.3$

d. Realice 10,000 simulaciones utilizando la semilla 221285 y reporte las primeras simulaciones obtenidas.

e. Genere un histograma con las 10,000 simulaciones anteriores y compárelo con una distribución construida utilizando la función `dbinom` de R.